{"version":3,"file":"index.modern.js","sources":["../src/constants/types.ts","../src/Hooks/useBrowserLocation.ts","../src/Hooks/useIntervalFn.ts","../src/Hooks/useCounter.ts","../src/Hooks/useDebounceFn.ts","../src/Hooks/useDebounce.ts","../src/Hooks/useGetRefValue.ts","../src/Hooks/useSetRefValue.ts","../src/Hooks/useThrottleFn.ts","../src/Hooks/useThrottle.ts","../src/Hooks/useAsync.ts","../src/Hooks/useCreateEventHook.ts"],"sourcesContent":["import { Ref } from 'vue';\n\nexport type Fn = () => void;\nexport type MaybeRef<T> = T | Ref<T>;\nexport type FunctionArgs<Args extends any[] = any[],Return = void> = (...args: Args) => Return\n\n/** 可控制方法 */\nexport interface Pauseable {\n  isActive: Ref<boolean>;\n  pause: Fn;\n  resume: Fn;\n}\n\n/** 判断是否是本客户端 */\nexport const isClient = typeof window !== 'undefined';\n\n/** 默认window */\nexport const defaultWindow = isClient ? window : undefined;\n","import { ref } from 'vue';\nimport { defaultWindow } from '../constants/types';\nexport interface BrowserLocationState {\n  trigger: string; // 触发\n  state?: any; // history.state\n  length?: number; // history.length\n  hash?: string; // 哈希\n  host?: string; // host\n  hostname?: string; // hostname\n  href?: string; // 完整链接\n  origin?: string; // 协议://host\n  pathname?: string; //host后面的path\n  port?: string; // 端口\n  protocol?: string; // 协议\n  search?: string; // 参数\n}\n\n/**\n * 获取当前域名location信息\n * @param window\n */\nexport function useBrowserLocation({ window = defaultWindow }: { window?: Window } = {}) {\n  const buildState = (trigger: string): BrowserLocationState => {\n    const { state, length } = window?.history || {};\n    const { hash, host, hostname, href, origin, pathname, port, protocol, search } = window?.location || {};\n\n    return {\n      trigger,\n      state,\n      length,\n      hash,\n      host,\n      hostname,\n      href,\n      origin,\n      pathname,\n      port,\n      protocol,\n      search,\n    };\n  };\n\n  // 默认\n  const state = ref(buildState('load'));\n  // 哈希改变 堆栈改变\n  if (window) {\n    window.addEventListener('popstate', () => (state.value = buildState('popstate')));\n    window.addEventListener('hashchange', () => (state.value = buildState('hashchange')));\n  }\n\n  return state;\n}\n\nexport type UseBroswerLocationReturn = ReturnType<typeof useBrowserLocation>;\n","import { Fn, isClient, Pauseable } from '../constants/types';\nimport { ref } from 'vue';\n\nexport interface IntervalFnOptions {\n  immediate?: boolean;\n  immediateCallback?: boolean;\n}\n\n/**\n * 改造版 setInterval\n * @param cb 回调\n * @param interval delay\n * @param options 立即回调配置\n */\nexport function useIntervalFn(cb: Fn, interval = 1000, options: IntervalFnOptions = {}): Pauseable {\n  const { immediate = true, immediateCallback = false } = options;\n\n  let timer: any = null;\n  const isActive = ref(false);\n\n  function clean() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n\n  function pause() {\n    isActive.value = false;\n    clean();\n  }\n\n  function resume() {\n    if (interval <= 0) {\n      return;\n    }\n    isActive.value = true;\n    if (immediateCallback) {\n      cb();\n    }\n    clean();\n    timer = setInterval(cb, interval);\n  }\n\n  if (immediate && isClient) {\n    resume();\n  }\n\n  return {\n    isActive,\n    pause,\n    resume,\n  };\n}\n","import { ref } from 'vue';\nexport function useCounter(initialValue: number = 0) {\n  const count = ref(initialValue);\n\n  const inc = (delta: number = 1) => (count.value += delta);\n  const dec = (delta: number = 1) => (count.value -= delta);\n  const get = () => count.value;\n  const set = (val: number) => (count.value = val);\n  const reset = (val: number = initialValue) => {\n    initialValue = val;\n    return set(val);\n  };\n\n  return { count, inc, dec, get, set, reset };\n}\n","import { FunctionArgs, MaybeRef } from '../constants/types';\n\n/**\n * Debounce execution of a function.\n *\n * @param  fn          A function to be executed after delay milliseconds debounced.\n * @param  delay          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n *\n * @return A new, debounce, function.\n */\nexport function useDebounceFn<T extends FunctionArgs>(fn: T, delay: number = 200) {\n  let timer: any = null;\n  return function (...args: any[]) {\n    if (timer) clearTimeout(timer);\n    timer = setTimeout(() => {\n      //@ts-expect-error\n      fn.apply(this, args);\n    }, delay);\n  };\n}\n","import { Ref, ref, watch } from 'vue';\nimport { useDebounceFn } from './useDebounceFn';\n\n/** debounce for ref\n * !!! donot use reactive state */\nexport function useDebounce<T>(value: Ref<T>, delay: number = 200): Readonly<Ref<T>> {\n  if (delay <= 0) {\n    return value;\n  }\n  const debounceRef = ref(value.value as T) as Ref<T>;\n\n  const updater = useDebounceFn(() => {\n    debounceRef.value = value.value;\n  }, delay);\n\n  watch(value, () => {\n    updater();\n  });\n  return debounceRef;\n}\n","import { unref } from 'vue';\nimport { MaybeRef } from './../constants/types';\n/**\n * 直接获取 ref 的值,支持传入ref对象，key\n */\n\nexport function useGetRefValue<T>(ref: MaybeRef<T>): T;\nexport function useGetRefValue<T, K extends keyof T>(ref: MaybeRef<T>, key: K): T[K];\n\nexport function useGetRefValue(obj: MaybeRef<any>, key?: string | number | symbol) {\n  return key ? unref(obj)[key] : unref(obj);\n}\n","import { Ref } from 'vue';\nexport function useSetRefValue<T>(ref: Ref<T>, value: T): void;\nexport function useSetRefValue<O extends object, K extends keyof O>(target: O, key: K, value: O[K]): void;\n\n/**\n *\n * @param args 支持传入ref 或者 reactive 对象\n */\nexport function useSetRefValue(...args: any[]) {\n  if (args.length === 2) {\n    const [ref, value] = args;\n    ref.value = value;\n  }\n  if (args.length === 3) {\n    const [target, key, value] = args;\n    target[key] = value;\n  }\n}\n","import { FunctionArgs } from '../constants/types';\n\nexport function useThrottleFn<T extends FunctionArgs>(fn: T, delay: number = 200) {\n  let lock = false;\n  return function (...args: any[]) {\n    if (lock) return;\n    lock = true;\n    setTimeout(() => {\n      //@ts-expect-error\n      fn.apply(this, args);\n      lock = false;\n    }, delay);\n  };\n}\n","import { ref, Ref, watch } from 'vue';\nimport { useThrottleFn } from './useThrottleFn';\n\nexport function useThrottle<T>(value: Ref<T>, delay: number = 200): Readonly<Ref<T>> {\n  if (delay <= 0) {\n    return value;\n  }\n\n  const throttled: Ref<T> = ref(value.value as T) as Ref<T>;\n\n  const updater = useThrottleFn(() => {\n    throttled.value = value.value;\n  }, delay);\n\n  watch(value, () => updater());\n  return throttled;\n}\n","import { reactive, ref } from 'vue';\nimport { useSetRefValue } from './useSetRefValue';\n\nexport type AsyncStatus = 'idle' | 'loading' | 'error' | 'success';\n\nexport interface AsyncResponse<T = any> {\n  data: T | null;\n  error: Error | null;\n  status: AsyncStatus;\n}\n\nexport const DefaultAsyncState: AsyncResponse<null> = {\n  data: null,\n  error: null,\n  status: 'idle',\n};\n\n/**\n * 简易版异步请求封装，旨在拿到各种实时异步状态和错误信息\n *\n * 状态有 'idle' | 'loading' | 'error' | 'success';\n * @param initialState 可选-初始数据\n * @returns AsyncResponse\n */\nexport function useAsync<D = any>(initialState?: AsyncResponse<D>) {\n  const state: AsyncResponse = reactive({\n    ...DefaultAsyncState,\n    ...initialState,\n  });\n\n  const setData = (payload: D) => {\n    state.data = payload;\n    state.error = null;\n    state.status = 'success';\n  };\n\n  const setError = (error: Error) => {\n    state.error = error;\n    state.data = null;\n    state.status = 'error';\n  };\n\n  const execute = (promise: Promise<D>) => {\n    if (!promise || !promise.then) {\n      throw new Error('payload must be Promise type');\n    }\n\n    useSetRefValue(state, 'status', 'loading');\n    return promise\n      .then((res: any) => {\n        setData(res);\n        return res;\n      })\n      .catch((error) => {\n        setError(error);\n        return error;\n      });\n  };\n\n  return {\n    execute,\n    setData,\n    setError,\n    state,\n  };\n}\n","/**\n * EventHook.ts 很类似发布订阅\n * 1. 注册全局变量存储事件\n * 2. 返回三个钩子: on、off、trigger 分别代表订阅，销毁和执行\n * 3. on 和 off 钩子需要传入参数为 T 的会回调函数\n */\n\nexport type EventHookOn<T = any> = (fn: (param: T) => void) => {\n  off: (param: T) => void;\n};\nexport type EventHookOff<T = any> = (fn: (oaram: T) => void) => void;\nexport type EventHookTrigger<T = any> = (param: T) => void;\n\nexport interface EventHook<T = any> {\n  on: EventHookOn<T>;\n  off: EventHookOff<T>;\n  trigger: EventHookTrigger<T>;\n}\n\nexport function useCreateEventHook<T = any>(): EventHook<T> {\n  const fns: Array<(param: T) => void> = [];\n\n  const off = (fn: (param: T) => void) => {\n    const index = fns.indexOf(fn);\n\n    if (index !== -1) {\n      fns.splice(index, 1);\n    }\n  };\n\n  const on = (fn: (param: T) => void) => {\n    fns.push(fn);\n\n    return {\n      off: () => {\n        off(fn);\n      },\n    };\n  };\n\n  const trigger = (param: T) => {\n    fns.forEach((fn) => fn(param));\n  };\n\n  return {\n    on,\n    off,\n    trigger,\n  };\n}\n"],"names":["isClient","window","defaultWindow","undefined","useBrowserLocation","buildState","trigger","state","length","history","hash","host","hostname","href","origin","pathname","port","protocol","search","location","ref","addEventListener","value","useIntervalFn","cb","interval","options","immediate","immediateCallback","timer","isActive","clean","clearInterval","resume","setInterval","pause","useCounter","initialValue","count","set","val","inc","delta","dec","get","reset","useDebounceFn","fn","delay","args","clearTimeout","setTimeout","apply","this","useDebounce","debounceRef","updater","watch","useGetRefValue","obj","key","unref","useSetRefValue","target","useThrottleFn","lock","useThrottle","throttled","DefaultAsyncState","data","error","status","useAsync","initialState","reactive","setData","payload","setError","execute","promise","then","Error","res","catch","useCreateEventHook","fns","off","index","indexOf","splice","on","push","param","forEach"],"mappings":"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"}